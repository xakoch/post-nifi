<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostgreSQL Backup Monitor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeInDown 0.8s ease;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: fadeInUp 0.8s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-icon {
            font-size: 2rem;
            margin-right: 15px;
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }
        
        .status-healthy { background: #4CAF50; }
        .status-warning { background: #FF9800; }
        .status-error { background: #F44336; }
        .status-unknown { background: #9E9E9E; }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .metric:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            font-weight: 500;
            color: #666;
        }
        
        .metric-value {
            font-weight: 600;
            color: #333;
        }
        
        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn-success { background: linear-gradient(45deg, #4CAF50, #45a049); }
        .btn-warning { background: linear-gradient(45deg, #FF9800, #f57c00); }
        .btn-danger { background: linear-gradient(45deg, #F44336, #d32f2f); }
        .btn-info { background: linear-gradient(45deg, #2196F3, #1976d2); }
        
        .logs-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-top: 20px;
            animation: fadeInUp 0.8s ease 0.2s both;
        }
        
        .logs-content {
            background: #1e1e1e;
            color: #e0e0e0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.5;
        }
        
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #666;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            animation: slideIn 0.5s ease;
        }
        
        .alert-success {
            background: linear-gradient(90deg, #d4edda, #c3e6cb);
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .alert-error {
            background: linear-gradient(90deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        .alert-warning {
            background: linear-gradient(90deg, #fff3cd, #ffeaa7);
            color: #856404;
            border-left: 4px solid #ffc107;
        }
        
        .chart-container {
            height: 200px;
            margin: 20px 0;
            position: relative;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.5s ease;
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tooltip {
            position: relative;
            cursor: help;
        }
        
        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .buttons {
                justify-content: center;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß PostgreSQL Backup Monitor</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±—ç–∫–∞–ø–æ–≤ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</p>
        </div>
        
        <div class="dashboard">
            <!-- –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üü¢</div>
                    <div class="card-title">
                        –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
                        <span id="statusIndicator" class="status-indicator status-unknown"></span>
                    </div>
                </div>
                <div id="systemMetrics">
                    <div class="loading">
                        <div class="spinner"></div>
                        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                    </div>
                </div>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—ç–∫–∞–ø–∞—Ö -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üíæ</div>
                    <div class="card-title">–ë—ç–∫–∞–ø—ã</div>
                </div>
                <div id="backupInfo">
                    <div class="metric">
                        <span class="metric-label">–ü–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø:</span>
                        <span class="metric-value" id="lastBackup">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">–†–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞:</span>
                        <span class="metric-value" id="backupSize">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">–í—Å–µ–≥–æ –±—ç–∫–∞–ø–æ–≤:</span>
                        <span class="metric-value" id="totalBackups">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="backupProgress" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <!-- PostgreSQL Status -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üêò</div>
                    <div class="card-title">PostgreSQL</div>
                </div>
                <div id="postgresInfo">
                    <div class="metric">
                        <span class="metric-label">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:</span>
                        <span class="metric-value" id="pgStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">–•–æ—Å—Ç:</span>
                        <span class="metric-value">164.90.236.33:5432</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:</span>
                        <span class="metric-value">mydb</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</span>
                        <span class="metric-value">admin</span>
                    </div>
                </div>
            </div>
            
            <!-- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üì±</div>
                    <div class="card-title">Telegram</div>
                </div>
                <div>
                    <div class="metric">
                        <span class="metric-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</span>
                        <span class="metric-value">–í–∫–ª—é—á–µ–Ω—ã ‚úÖ</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">–ì—Ä—É–ø–ø–∞:</span>
                        <span class="metric-value">-4858075310</span>
                    </div>
                    <button class="btn btn-info" onclick="testTelegram()">
                        üì≤ –¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">‚öôÔ∏è</div>
                <div class="card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</div>
            </div>
            
            <div class="buttons">
                <button class="btn" onclick="checkStatus()">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
                </button>
                <button class="btn btn-success" onclick="createBackup()">
                    üíæ –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
                </button>
                <button class="btn btn-info" onclick="showBackups()">
                    üìÅ –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
                </button>
                <button class="btn btn-warning" onclick="showLogs()">
                    üìã –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
                </button>
                <a href="https://164.90.236.33:8443/nifi" target="_blank" class="btn btn-info">
                    üåä –û—Ç–∫—Ä—ã—Ç—å NiFi
                </a>
            </div>
            
            <div id="alerts"></div>
        </div>
        
        <!-- –õ–æ–≥–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="logs-container" id="logsContainer" style="display: none;">
            <div class="card-header">
                <div class="card-icon">üìã</div>
                <div class="card-title">–°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏</div>
            </div>
            <div class="logs-content" id="logsContent">
                –ù–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏" –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏...
            </div>
        </div>
    </div>

    <script>
        let statusCheckInterval;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            showAlert('üöÄ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–≥—Ä—É–∂–µ–Ω. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏—Å—Ç–µ–º—É...', 'success');
            setTimeout(checkStatus, 1000);
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            statusCheckInterval = setInterval(checkStatus, 30000);
        };
        
        async function checkStatus() {
            try {
                const response = await fetch('/status.json');
                const data = await response.json();
                
                updateSystemStatus(data);
                updateStatusIndicator(data.status);
                
                if (data.status === 'healthy') {
                    showAlert('‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ', 'success', 3000);
                } else if (data.status === 'warning') {
                    showAlert('‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ', 'warning');
                } else if (data.status === 'error') {
                    showAlert('‚ùå –û—à–∏–±–∫–∞ –≤ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã', 'error');
                }
                
            } catch (error) {
                updateSystemStatus({
                    status: 'error',
                    error: error.message,
                    time: new Date().toISOString()
                });
                updateStatusIndicator('error');
                showAlert('‚ùå –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã: ' + error.message, 'error');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±—ç–∫–∞–ø–∞—Ö
            await updateBackupInfo();
        }
        
        function updateSystemStatus(data) {
            const metricsDiv = document.getElementById('systemMetrics');
            const lastCheck = new Date(data.time || data.last_check).toLocaleString('ru-RU');
            
            metricsDiv.innerHTML = `
                <div class="metric">
                    <span class="metric-label">–°—Ç–∞—Ç—É—Å:</span>
                    <span class="metric-value">${getStatusText(data.status)}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</span>
                    <span class="metric-value">${lastCheck}</span>
                </div>
                <div class="metric">
                    <span class="metric-label">PostgreSQL:</span>
                    <span class="metric-value">${data.postgres_status || 'unknown'}</span>
                </div>
                ${data.uptime ? `
                <div class="metric">
                    <span class="metric-label">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:</span>
                    <span class="metric-value">${data.uptime}</span>
                </div>
                ` : ''}
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º PostgreSQL —Å—Ç–∞—Ç—É—Å
            document.getElementById('pgStatus').textContent = 
                data.postgres_status === 'online' ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ ‚úÖ' : '–û—Ç–∫–ª—é—á–µ–Ω–æ ‚ùå';
        }
        
        function updateStatusIndicator(status) {
            const indicator = document.getElementById('statusIndicator');
            indicator.className = 'status-indicator status-' + (status || 'unknown');
        }
        
        function getStatusText(status) {
            const statusMap = {
                'healthy': '–ó–¥–æ—Ä–æ–≤–∞—è ‚úÖ',
                'warning': '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ‚ö†Ô∏è',
                'error': '–û—à–∏–±–∫–∞ ‚ùå',
                'running': '–†–∞–±–æ—Ç–∞–µ—Ç üü¢',
                'offline': '–û—Ñ–ª–∞–π–Ω üî¥'
            };
            return statusMap[status] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ ‚ùì';
        }
        
        async function updateBackupInfo() {
            try {
                const response = await fetch('/backups/');
                const data = await response.json();
                
                if (data && Array.isArray(data)) {
                    const backupFiles = data.filter(file => file.name.endsWith('.sql'));
                    const totalBackups = backupFiles.length;
                    
                    document.getElementById('totalBackups').textContent = totalBackups;
                    
                    if (totalBackups > 0) {
                        const latestBackup = backupFiles.sort((a, b) => 
                            new Date(b.mtime) - new Date(a.mtime)
                        )[0];
                        
                        document.getElementById('lastBackup').textContent = 
                            new Date(latestBackup.mtime).toLocaleString('ru-RU');
                        document.getElementById('backupSize').textContent = 
                            formatFileSize(latestBackup.size);
                        
                        // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
                        const progress = Math.min(100, (totalBackups / 10) * 100);
                        document.getElementById('backupProgress').style.width = progress + '%';
                    } else {
                        document.getElementById('lastBackup').textContent = '–ù–µ—Ç –±—ç–∫–∞–ø–æ–≤';
                        document.getElementById('backupSize').textContent = '-';
                    }
                }
            } catch (error) {
                console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±—ç–∫–∞–ø–∞—Ö:', error);
            }
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        async function createBackup() {
            showAlert('üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞...', 'success');
            
            // –ü–æ—Å–∫–æ–ª—å–∫—É —É –Ω–∞—Å –Ω–µ—Ç API endpoint, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            showAlert(`
                üíæ –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä—É—á–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:<br>
                <code style="background: #f0f0f0; padding: 5px; border-radius: 3px;">
                docker exec postgres_backup pg_dump -h postgres_db -U admin mydb > manual_backup_$(date +%Y%m%d_%H%M%S).sql
                </code>
            `, 'success', 10000);
        }
        
        async function showBackups() {
            try {
                const response = await fetch('/backups/');
                const data = await response.json();
                
                if (data && Array.isArray(data)) {
                    const backupFiles = data.filter(file => file.name.endsWith('.sql'));
                    
                    let backupList = '<h4>üìÅ –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤:</h4>';
                    if (backupFiles.length > 0) {
                        backupList += '<ul style="margin: 10px 0; padding-left: 20px;">';
                        backupFiles.forEach(file => {
                            const date = new Date(file.mtime).toLocaleString('ru-RU');
                            const size = formatFileSize(file.size);
                            backupList += `<li><strong>${file.name}</strong> - ${size} (${date})</li>`;
                        });
                        backupList += '</ul>';
                    } else {
                        backupList += '<p>–ë—ç–∫–∞–ø—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                    }
                    
                    showAlert(backupList, 'success', 10000);
                } else {
                    showAlert('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤', 'error');
                }
            } catch (error) {
                showAlert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –±—ç–∫–∞–ø–æ–≤: ' + error.message, 'error');
            }
        }
        
        function showLogs() {
            const container = document.getElementById('logsContainer');
            const content = document.getElementById('logsContent');
            
            if (container.style.display === 'none') {
                container.style.display = 'block';
                content.innerHTML = '<div class="loading"><div class="spinner"></div>–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</div>';
                
                // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤
                setTimeout(() => {
                    content.innerHTML = `
                        <div style="color: #4CAF50;">[${new Date().toLocaleString()}] ‚úÖ PostgreSQL connection established</div>
                        <div style="color: #2196F3;">[${new Date().toLocaleString()}] üîÑ Backup system monitoring...</div>
                        <div style="color: #4CAF50;">[${new Date().toLocaleString()}] ‚úÖ System status: healthy</div>
                        <div style="color: #FF9800;">[${new Date().toLocaleString()}] ‚ö†Ô∏è No recent backups found</div>
                        <div style="color: #4CAF50;">[${new Date().toLocaleString()}] üì± Telegram notifications: enabled</div>
                        <div style="color: #2196F3;">[${new Date().toLocaleString()}] üîÑ System monitoring active</div>
                        <div style="color: #9E9E9E;">--- –î–ª—è –ø–æ–ª–Ω—ã—Ö –ª–æ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: docker logs postgres_backup ---</div>
                    `;
                }, 1000);
            } else {
                container.style.display = 'none';
            }
        }
        
        async function testTelegram() {
            showAlert('üì± –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram...', 'success');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            showAlert(`
                üì≤ –¢–µ—Å—Ç Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:<br>
                <code style="background: #f0f0f0; padding: 5px; border-radius: 3px;">
                curl -X POST "https://api.telegram.org/bot6869952608:AAEQYMFVhh4cDXBWT7X5n8Q7rcPpoCatVRs/sendMessage" -d "chat_id=-4858075310&text=üîß Test from Backup Monitor"
                </code>
            `, 'success', 15000);
        }
        
        function showAlert(message, type = 'success', duration = 5000) {
            const alertsContainer = document.getElementById('alerts');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = message;
            
            alertsContainer.appendChild(alertDiv);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.style.animation = 'fadeOut 0.5s ease';
                    setTimeout(() => {
                        alertDiv.remove();
                    }, 500);
                }
            }, duration);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        window.addEventListener('error', function(e) {
            showAlert('‚ùå –û—à–∏–±–∫–∞ JavaScript: ' + e.message, 'error');
        });
        
        // –î–æ–±–∞–≤–ª—è–µ–º CSS –¥–ª—è fadeOut –∞–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                from { opacity: 1; transform: translateX(0); }
                to { opacity: 0; transform: translateX(-20px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
